sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/core/UIComponent","sap/ui/core/routing/History"],function(e,t,o){"use strict";return e.extend("empreg.controller.Integrationlist",{onInit:function(){this.oList=this.byId("employeelist");this.oDataModel=this.getOwnerComponent().getModel();this.getView().setModel(this.oDataModel)},getRouter:function(){return t.getRouterFor(this)},onNavBack:function(){var e,t;e=o.getInstance();t=e.getPreviousHash();if(t!==undefined){window.history.go(-1)}else{this.getRouter().navTo("View1",{},true)}},onAdvancedSearch:function(e){var t=e.getParameter("newValue");var o=this.getView().byId("employeelist");var a=o.getBinding("items");if(a){var r=[];var n=t.toLowerCase();var i=[{term:["cloud","cloud development","cloud application programming","cloud application programming model","capm"],matches:["cloud","cloud development","cloud application programming","cloud application programming model","capm"]},{term:["javascript"],matches:["react","node.js"]},{term:["azure"],matches:["devops","aws","azure"]},{term:["frontend developer"],matches:["html","css","Angular","Fullstack","react.js","vue.js","javascript","wordpress","Fiori"]},{term:["backend developer"],matches:["ABAP","node js","java","Fullstack","python","c","capm","cap","cloud","cloud development","cloud application programming","cloud application programming model","sql","hana database","php"]},{term:["data science"],matches:["Phyton","Data engineer"]},{term:["solution Architect"],matches:["agile","cloud computing"]}];i.forEach(function(e){if(e.term.includes(n)){e.matches.forEach(function(e){var t=new sap.ui.model.Filter({path:"skills",operator:sap.ui.model.FilterOperator.Contains,value1:e,caseSensitive:false});r.push(t)})}});if(r.length===0){var l=new sap.ui.model.Filter({path:"skills",operator:sap.ui.model.FilterOperator.Contains,value1:t,caseSensitive:false});r.push(l)}var s=new sap.ui.model.Filter({path:"fname",operator:sap.ui.model.FilterOperator.Contains,value1:t,caseSensitive:false});var c=new sap.ui.model.Filter({path:"lname",operator:sap.ui.model.FilterOperator.Contains,value1:t,caseSensitive:false});var u=new sap.ui.model.Filter({path:"desig",operator:sap.ui.model.FilterOperator.Contains,value1:t,caseSensitive:false});var p=new sap.ui.model.Filter({path:"email",operator:sap.ui.model.FilterOperator.Contains,value1:t,caseSensitive:false});var d=new sap.ui.model.Filter({path:"country/name",operator:sap.ui.model.FilterOperator.Contains,value1:t,caseSensitive:false});r.push(s,c,u,p,d);var m=new sap.ui.model.Filter({filters:r,and:false});a.filter(m)}},onaddnewemployee:function(){var e=this.getOwnerComponent().getRouter();e.navTo("View5")},onListItemPress:function(e){var t=e.getSource();if(t){var o=t.getBindingContext("MainModel");if(o){var a=o.getProperty("ID");var r=sap.ui.core.UIComponent.getRouterFor(this);r.navTo("View6",{SEmployeeId:a})}else{console.error("Binding context is not available.")}}else{console.error("List item is not available.")}},formatPhoto:function(e,t){console.log("Employee ID:",e);console.log("Gender received:",t);var o="images/default-boy.jpg";var a="images/default-girl.jpg";function r(e){return new Promise(function(t,o){var a=new Image;a.src=e;a.onload=function(){console.log("Image loaded successfully");t(e)};a.onerror=function(){console.error("Image not found, using default");t(null)}})}if(e){var n="images/"+e+".jpg";console.log("Employee Image URL:",n);return r(n).then(function(e){return e||(t==="Male"?o:a)})}return t==="Male"?o:a},onLogout:function(){sap.ui.core.UIComponent.getRouterFor(this).navTo("View1")},handleSelectionChange:async function(e){try{var t=e.getSource();var o=t.getSelectedItems();var a=o.map(function(e){return e.getKey()});console.log("Selected Skills: ",a);var r=this.getView().byId("employeelist");var n=r.getBinding("items");if(!n){console.error("Binding is undefined.");return}var i=[];a.forEach(function(e){if(e){console.log("Filtering for skill: "+e);var t=e.split(",");var o=t.map(function(e){return new sap.ui.model.Filter({path:"skills",operator:sap.ui.model.FilterOperator.Contains,value1:e.trim(),caseSensitive:false})});var a=new sap.ui.model.Filter(o,false);i.push(a);console.log("Added filter for skill: "+e)}});console.log("Applied Filters: ",i);var l=new sap.ui.model.Filter(i,true);console.log("Combined Filter: ",l);n.filter(l);var s=await this._getFilteredItems(n);console.log("Filtered Data: ",s);if(a.length===0){n.filter([])}}catch(e){console.error("Error: ",e)}},_getFilteredItems:function(e){return new Promise(function(t,o){e.attachEventOnce("dataReceived",function(){var o=e.getCurrentContexts().map(function(e){if(e&&e.getObject){var t=e.getObject();return t}return null});t(o)})})},handleSelectionFinish:function(e){var t=e.getParameter("selectedItems");if(t.length>0){for(var o=0;o<t.length;o++){var a=t[o];var r=a.getKey();var n=a.getText();console.log("Selected Key: "+r);console.log("Selected Text: "+n)}}else{console.log("No items selected.")}}})});